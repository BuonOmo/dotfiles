function todo {
	(( $# < 1 )) && cat ~/.todo && return

	local id=1
	[[ "$(tail ~/.todo)" =~ '#[0-9]+' ]] && id=$(($(tail -1 ~/.todo | grep -Eo '#\d+' | tr -d '#') + 1))
	case "$@" in
		-e|--edit|edit) $EDITOR ~/.todo ;;
		-c|--clear|clear) sed -I '' -n 1p ~/.todo ;;
		-p|--pick|pick)
			local line=$(cat ~/.todo | tac | fzf --ansi)
			[[ -z "$line" ]] || {
				sed -I '' "/$(echo $line | rg --only-matching '#\d+')/d" ~/.todo
				echo $line
			}
			;;
		''|*[!0-9]*)
			echo "- $@ $(tput bold)#$id$(tput sgr0)" >> ~/.todo
		    echo "#$id"
			;;
		*) sed -I '' "/#$1/d" ~/.todo ;;
	esac
}
# We need to execute the function because the content of this file is not only
# a function. The default behaviour of autoload is:
#
# 1. If there is only a function body, load and execute the function.
# 2. If there are other commands, load and consider the function initialized.
#
# See 'AUTOLOADING FUNCTIONS' in man zshall
todo "$@"
